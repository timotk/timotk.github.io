<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>A Terminal Spinner in Python | Timo's Blog</title><meta name=keywords content="python,terminal"><meta name=description content="We are going to build a spinning status indicator that runs while other code is executing.
It will look like this: Why? You&rsquo;ve got some code that takes a while to run.
import time import random def slow_func(): seconds = random.randint(2, 5) time.sleep(seconds) print(&#34;Done!&#34;) if __name__ == '__main__': slow_func() Now, when you execute this, you&rsquo;ll see the following: You&rsquo;ll wonder whether your code or your system is working correctly or frozen."><meta name=author content="Timo"><link rel=canonical href=https://timotk.github.io/posts/a-terminal-spinner-in-python/><link crossorigin=anonymous href=/assets/css/stylesheet.7864430f35272245e93d85b17dfcdfeac51801bec1fb66a9a1767af6ddeab5a9.css integrity="sha256-eGRDDzUnIkXpPYWxffzf6sUYAb7B+2apoXZ69t3qtak=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://timotk.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://timotk.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://timotk.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://timotk.github.io/apple-touch-icon.png><link rel=mask-icon href=https://timotk.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="A Terminal Spinner in Python"><meta property="og:description" content="We are going to build a spinning status indicator that runs while other code is executing.
It will look like this: Why? You&rsquo;ve got some code that takes a while to run.
import time import random def slow_func(): seconds = random.randint(2, 5) time.sleep(seconds) print(&#34;Done!&#34;) if __name__ == '__main__': slow_func() Now, when you execute this, you&rsquo;ll see the following: You&rsquo;ll wonder whether your code or your system is working correctly or frozen."><meta property="og:type" content="article"><meta property="og:url" content="https://timotk.github.io/posts/a-terminal-spinner-in-python/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-06-25T12:30:00+02:00"><meta property="article:modified_time" content="2022-06-25T12:30:00+02:00"><meta property="og:site_name" content="Timo's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="A Terminal Spinner in Python"><meta name=twitter:description content="We are going to build a spinning status indicator that runs while other code is executing.
It will look like this: Why? You&rsquo;ve got some code that takes a while to run.
import time import random def slow_func(): seconds = random.randint(2, 5) time.sleep(seconds) print(&#34;Done!&#34;) if __name__ == '__main__': slow_func() Now, when you execute this, you&rsquo;ll see the following: You&rsquo;ll wonder whether your code or your system is working correctly or frozen."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://timotk.github.io/posts/"},{"@type":"ListItem","position":3,"name":"A Terminal Spinner in Python","item":"https://timotk.github.io/posts/a-terminal-spinner-in-python/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"A Terminal Spinner in Python","name":"A Terminal Spinner in Python","description":"We are going to build a spinning status indicator that runs while other code is executing.\nIt will look like this: Why? You\u0026rsquo;ve got some code that takes a while to run.\nimport time import random def slow_func(): seconds = random.randint(2, 5) time.sleep(seconds) print(\u0026#34;Done!\u0026#34;) if __name__ == \u0026#39;__main__\u0026#39;: slow_func() Now, when you execute this, you\u0026rsquo;ll see the following: You\u0026rsquo;ll wonder whether your code or your system is working correctly or frozen.","keywords":["python","terminal"],"articleBody":"We are going to build a spinning status indicator that runs while other code is executing.\nIt will look like this: Why? Youâ€™ve got some code that takes a while to run.\nimport time import random def slow_func(): seconds = random.randint(2, 5) time.sleep(seconds) print(\"Done!\") if __name__ == '__main__': slow_func() Now, when you execute this, youâ€™ll see the following: Youâ€™ll wonder whether your code or your system is working correctly or frozen. Who knows?\nIntroducing a spinner Ideally, weâ€™d like to show some sort of activity while our code is executing. We can do that with a spinner. To create a spinner, we can use:\nimport time import itertools def spin(): spinners = [\"|\", \"/\", \"-\", \"\\\\\"] for c in itertools.cycle(spinners): print(f\"\\r{c}\", end=\"\") time.sleep(0.1) We introduce a list of spinners (| / - \\ ). The double backslash is used because of escaping. Using itertools.cycle, we can create an endless cycle of our spinner elements. In each iteration, we print one of characters. By default, Python ends a print statement with a newline. We disable that by printing an empty string (end=\"\") By putting \\r in front of our character, we move our cursor back to the start of the line. This is called a carriage return. We sleep for 100ms. Combine the spinner with the code Now, combining them can be done like this:\nspin() slow_func() But obviously this does not work, since our code executes sequentially. First the spinner runs to completion, then slow_func will run. Due to the endless nature of itertools.cycle, our code in spin() never stops.\nTo solve this, we can run our spinner in its own thread, which allows us to run code in parallel:\nimport threading if __name__ == '__main__': thread = threading.Thread(target=spin) thread.daemon = True thread.start() slow_func() We start a new thread, with the spin function as its target. We set thread.daemon to True, to make the thread run in the background. We start the thread. We call our slow function Hereâ€™s what it looks like: Making it awesome If you want to reuse your code, it wouldnâ€™t be so nice. To fix that, we can introduce a context manager. This will make usage look like this:\nwith Spinner(): slow_func() Hereâ€™s how we write the context manager:\nclass Spinner: def __init__(self): self.running = False self.thread = threading.Thread(target=self.spin) self.thread.daemon = True def spin(self): spinners = [\"|\", \"/\", \"-\", \"\\\\\"] for c in itertools.cycle(spinners): if not self.running: print(\"\\r\", end=\"\") break print(f\"\\r{c}\", end=\"\") time.sleep(0.1) def __enter__(self): self.running = True self.thread.start() def __exit__(self, exc_type, exc_val, exc_tb): self.running = False The logic is:\nWe initialize the instance with Spinner(). This calls __init__(), which sets running to False and creates the thread. After the with Spinner(): line, Spinner.__enter__() gets called. We now enter the context and the thread starts running. Our slow function runs. Meanwhile, every 100ms, a spin character gets printed. Our slow function ends and we exit the with block. Now, Spinner.__exit__() gets called. Running will be set to False, which means the spin() method will break out of its loop, once it detects self.running is False. Further improvements We can make our code even more dynamic, by allowing you to set the spin timeout and the spinners during class initialization. Hereâ€™s the full code:\nimport itertools import threading import time class Spinner: def __init__(self, timeout: float = 0.1, spinners: list = [\"|\", \"/\", \"-\", \"\\\\\"]): self.timeout = timeout self.spinners = spinners self.running = False self.thread = threading.Thread(target=self.spin) self.thread.daemon = True def spin(self): for c in itertools.cycle(self.spinners): if not self.running: print(\"\\r\", end=\"\") break print(f\"\\r{c}\", end=\"\") time.sleep(self.timeout) def __enter__(self): self.running = True self.thread.start() def __exit__(self, exc_type, exc_val, exc_tb): self.running = False You could use any spinners you like, for example:\n[\"â¢¿\", \"â£»\", \"â£½\", \"â£¾\", \"â£·\", \"â£¯\", \"â£Ÿ\", \"â¡¿\"] [\"ðŸ‘†\", \"ðŸ‘‰\", \"ðŸ‘‡\", \"ðŸ‘ˆ\"] [\"| \", \" | \", \" | \", \" |\"] You can find many more examples online, or you can simply make your own.\nFinal thoughts I hoped you learned something about how we can indicate activity while you are running your program interactively. If you need a more extensive approach, you can use a library like rich.\n","wordCount":"682","inLanguage":"en","datePublished":"2022-06-25T12:30:00+02:00","dateModified":"2022-06-25T12:30:00+02:00","author":{"@type":"Person","name":"Timo"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://timotk.github.io/posts/a-terminal-spinner-in-python/"},"publisher":{"@type":"Organization","name":"Timo's Blog","logo":{"@type":"ImageObject","url":"https://timotk.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://timotk.github.io accesskey=h title="Timo's Blog (Alt + H)">Timo's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://timotk.github.io/ title=Home><span>Home</span></a></li><li><a href=https://timotk.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://timotk.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://timotk.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://timotk.github.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>A Terminal Spinner in Python</h1><div class=post-meta><span title='2022-06-25 12:30:00 +0200 +0200'>June 25, 2022</span>&nbsp;Â·&nbsp;4 min&nbsp;Â·&nbsp;682 words&nbsp;|&nbsp;<a href=https://github.com/timotk/timotk.github.io/tree/main/content/posts/a-terminal-spinner-in-python.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>We are going to build a spinning status indicator that runs while other code is executing.</p><p>It will look like this:
<img loading=lazy src=/images/spinner.gif alt></p><h2 id=why>Why?<a hidden class=anchor aria-hidden=true href=#why>#</a></h2><p>You&rsquo;ve got some code that takes a while to run.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>slow_func</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>seconds</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=n>seconds</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Done!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>slow_func</span><span class=p>()</span>
</span></span></code></pre></div><p>Now, when you execute this, you&rsquo;ll see the following:
<img loading=lazy src=/images/terminal-busy-block.png alt></p><p>You&rsquo;ll wonder whether your code or your system is working correctly or frozen. Who knows?</p><h2 id=introducing-a-spinner>Introducing a spinner<a hidden class=anchor aria-hidden=true href=#introducing-a-spinner>#</a></h2><p>Ideally, we&rsquo;d like to show some sort of activity while our code is executing.
We can do that with a spinner. To create a spinner, we can use:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>itertools</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>spin</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>spinners</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;|&#34;</span><span class=p>,</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span> <span class=s2>&#34;-&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=se>\\</span><span class=s2>&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>itertools</span><span class=o>.</span><span class=n>cycle</span><span class=p>(</span><span class=n>spinners</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\r</span><span class=si>{</span><span class=n>c</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
</span></span></code></pre></div><ol><li>We introduce a list of spinners (<code>| / - \ </code>). The double backslash is used because of <a href=https://www.freecodecamp.org/news/escape-sequences-python/>escaping</a>.</li><li>Using <code>itertools.cycle</code>, we can create an endless <em>cycle</em> of our spinner elements.</li><li>In each iteration, we print one of characters.<ol><li>By default, Python ends a print statement with a newline. We disable that by printing an empty string (<code>end=""</code>)</li><li>By putting <code>\r</code> in front of our character, we move our cursor back to the start of the line. This is called a <a href=https://en.wikipedia.org/wiki/Carriage_return>carriage return</a>.</li><li>We sleep for 100ms.</li></ol></li></ol><h1 id=combine-the-spinner-with-the-code>Combine the spinner with the code<a hidden class=anchor aria-hidden=true href=#combine-the-spinner-with-the-code>#</a></h1><p>Now, combining them can be done like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>spin</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>slow_func</span><span class=p>()</span>
</span></span></code></pre></div><p>But obviously this does not work, since our code executes sequentially.
First the spinner runs to completion, then <code>slow_func</code> will run.
Due to the endless nature of <code>itertools.cycle</code>, our code in <code>spin()</code> never stops.</p><p>To solve this, we can run our spinner in its own <a href=https://docs.python.org/3/library/threading.html>thread</a>, which allows us to run code in parallel:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>threading</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>thread</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=n>spin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>thread</span><span class=o>.</span><span class=n>daemon</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=n>thread</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>slow_func</span><span class=p>()</span>
</span></span></code></pre></div><ol><li>We start a new thread, with the <code>spin</code> function as its target.</li><li>We set <code>thread.daemon</code> to True, to make the thread run in the background.</li><li>We start the thread.</li><li>We call our slow function</li></ol><p>Here&rsquo;s what it looks like:
<img loading=lazy src=/images/spinner.gif alt></p><h1 id=making-it-awesome>Making it awesome<a hidden class=anchor aria-hidden=true href=#making-it-awesome>#</a></h1><p>If you want to reuse your code, it wouldn&rsquo;t be so nice. To fix that, we can introduce a <a href=https://docs.python.org/3/reference/datamodel.html#context-managers>context manager</a>.
This will make usage look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>with</span> <span class=n>Spinner</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>slow_func</span><span class=p>()</span>
</span></span></code></pre></div><p>Here&rsquo;s how we write the context manager:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Spinner</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>running</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thread</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>spin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thread</span><span class=o>.</span><span class=n>daemon</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>spin</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>spinners</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;|&#34;</span><span class=p>,</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span> <span class=s2>&#34;-&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=se>\\</span><span class=s2>&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>itertools</span><span class=o>.</span><span class=n>cycle</span><span class=p>(</span><span class=n>spinners</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>running</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\r</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\r</span><span class=si>{</span><span class=n>c</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__enter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>running</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thread</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__exit__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>exc_type</span><span class=p>,</span> <span class=n>exc_val</span><span class=p>,</span> <span class=n>exc_tb</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>running</span> <span class=o>=</span> <span class=kc>False</span>
</span></span></code></pre></div><p>The logic is:</p><ol><li>We initialize the instance with <code>Spinner()</code>. This calls <code>__init__()</code>, which sets running to <code>False</code> and creates the thread.</li><li>After the <code>with Spinner():</code> line, <code>Spinner.__enter__()</code> gets called. We now enter the context and the thread starts running.</li><li>Our slow function runs. Meanwhile, every 100ms, a spin character gets printed.</li><li>Our slow function ends and we exit the <code>with</code> block. Now, <code>Spinner.__exit__()</code> gets called. Running will be set to <code>False</code>, which means the <code>spin()</code> method will break out of its loop, once it detects <code>self.running</code> is <code>False</code>.</li></ol><h1 id=further-improvements>Further improvements<a hidden class=anchor aria-hidden=true href=#further-improvements>#</a></h1><p>We can make our code even more dynamic, by allowing you to set the spin timeout and the spinners during class initialization.
Here&rsquo;s the full code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>itertools</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>threading</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Spinner</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>timeout</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>spinners</span><span class=p>:</span> <span class=nb>list</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;|&#34;</span><span class=p>,</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span> <span class=s2>&#34;-&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=se>\\</span><span class=s2>&#34;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>timeout</span> <span class=o>=</span> <span class=n>timeout</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>spinners</span> <span class=o>=</span> <span class=n>spinners</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>running</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thread</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>spin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thread</span><span class=o>.</span><span class=n>daemon</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>spin</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>itertools</span><span class=o>.</span><span class=n>cycle</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>spinners</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>running</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\r</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\r</span><span class=si>{</span><span class=n>c</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>timeout</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__enter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>running</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thread</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__exit__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>exc_type</span><span class=p>,</span> <span class=n>exc_val</span><span class=p>,</span> <span class=n>exc_tb</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>running</span> <span class=o>=</span> <span class=kc>False</span>
</span></span></code></pre></div><p>You could use any spinners you like, for example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[</span><span class=s2>&#34;â¢¿&#34;</span><span class=p>,</span> <span class=s2>&#34;â£»&#34;</span><span class=p>,</span> <span class=s2>&#34;â£½&#34;</span><span class=p>,</span> <span class=s2>&#34;â£¾&#34;</span><span class=p>,</span> <span class=s2>&#34;â£·&#34;</span><span class=p>,</span> <span class=s2>&#34;â£¯&#34;</span><span class=p>,</span> <span class=s2>&#34;â£Ÿ&#34;</span><span class=p>,</span> <span class=s2>&#34;â¡¿&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=s2>&#34;ðŸ‘†&#34;</span><span class=p>,</span> <span class=s2>&#34;ðŸ‘‰&#34;</span><span class=p>,</span> <span class=s2>&#34;ðŸ‘‡&#34;</span><span class=p>,</span> <span class=s2>&#34;ðŸ‘ˆ&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=s2>&#34;|   &#34;</span><span class=p>,</span> <span class=s2>&#34; |  &#34;</span><span class=p>,</span> <span class=s2>&#34;  | &#34;</span><span class=p>,</span> <span class=s2>&#34;   |&#34;</span><span class=p>]</span>
</span></span></code></pre></div><p>You can find many more examples online, or you can simply make your own.</p><h1 id=final-thoughts>Final thoughts<a hidden class=anchor aria-hidden=true href=#final-thoughts>#</a></h1><p>I hoped you learned something about how we can indicate activity while you are running your program interactively.
If you need a more extensive approach, you can use a library like <a href=https://github.com/Textualize/rich>rich</a>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://timotk.github.io/tags/python/>python</a></li><li><a href=https://timotk.github.io/tags/terminal/>terminal</a></li></ul><nav class=paginav><a class=prev href=https://timotk.github.io/posts/enforce-validate-llm-output-pydantic/><span class=title>Â« Prev</span><br><span>Enforce and Validate LLM Output with Pydantic</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://timotk.github.io>Timo's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>